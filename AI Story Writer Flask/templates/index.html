<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AI Story Writer</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .container { max-width: 600px; margin: auto; }
        .story { margin-top: 30px; padding: 20px; background: #f4f4f4; border-radius: 8px; }
        label { display: block; margin-top: 15px; }
        input, select, button { margin-top: 5px; padding: 8px; width: 100%; box-sizing: border-box; }
    </style>
</head>
<body>
<div class="container">
    <h1>AI Story Writer</h1>
    <form method="post">
        <label for="subject">Story Subject:</label>
        <input type="text" id="subject" name="subject" required>


        <label for="author">Author:</label>
        <input type="text" id="author" name="author" required oninput="checkAuthor()">

        <div id="dropdown-container" style="display:none;">
            <label for="selected_author">Select a famous author:</label>
            <select id="selected_author" name="selected_author">
                <option value="">--Choose an author--</option>
                {% for a in authors %}
                    <option value="{{ a }}">{{ a }}</option>
                {% endfor %}
            </select>
        </div>

        <script>
        function checkAuthor() {
            const author = document.getElementById('author').value;
            fetch('/check_author', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ author })
            })
            .then(response => response.json())
            .then(data => {
                const dropdown = document.getElementById('dropdown-container');
                if (!data.established && author.trim() !== '') {
                    dropdown.style.display = 'block';
                } else {
                    dropdown.style.display = 'none';
                }
            });
        }
        </script>

        <button type="submit">Generate Story</button>
    </form>

    {% if story %}
        <div class="story">
            <h2>Generated Story</h2>
            <p>{{ story }}</p>
        </div>
    {% endif %}
</div>
</body>
</html>
